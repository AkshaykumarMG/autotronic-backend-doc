<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>back-auto-tronic documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">back-auto-tronic documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >AwsS3Service</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/utilities/services/aws_s3/aws_s3.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#s3Client" >s3Client</a>
                            </li>
                            <li>
                                <a href="#strDefaultAWSBaseURL" >strDefaultAWSBaseURL</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#createUrlForDelete" >createUrlForDelete</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#createUrlForDownload" >createUrlForDownload</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#createUrlForUpload" >createUrlForUpload</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#delete" >delete</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#deleteMultiple" >deleteMultiple</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#get" >get</a>
                            </li>
                            <li>
                                <a href="#getMediaPathByType" >getMediaPathByType</a>
                            </li>
                            <li>
                                <a href="#getMediaTypeForPath" >getMediaTypeForPath</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#upload" >upload</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor()</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:35</a></div>
                            </td>
                        </tr>

            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createUrlForDelete"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>createUrlForDelete</b></span>
                        <a href="#createUrlForDelete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createUrlForDelete(key: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="180"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:180</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Creates a pre-signed URL for deleting a file from Amazon S3.</p>
<p>This function generates a pre-signed URL that allows temporary access to delete
a specific object from the S3 bucket. The URL is signed with the AWS credentials
and expires after 20 seconds.</p>
<b>Example :</b><div><pre class="line-numbers"><code class="language-none">     The URL can be used to delete the file without requiring AWS credentials.</code></pre></div></div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>key</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The unique identifier of the object in the S3 bucket to be deleted.</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The MediaType enum value representing the type of media being deleted.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves to a string containing the pre-signed URL for deleting the file.
The URL can be used to delete the file without requiring AWS credentials.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createUrlForDownload"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>createUrlForDownload</b></span>
                        <a href="#createUrlForDownload"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createUrlForDownload(key: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="160"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:160</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Creates a pre-signed URL for downloading a file from Amazon S3.</p>
<p>This function generates a pre-signed URL that allows temporary access to download
a specific object from the S3 bucket. The URL is signed with the AWS credentials
and expires after a set time.</p>
<p>The URL can be used to access and download the file without requiring AWS credentials.</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>key</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The unique identifier of the object in the S3 bucket.</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The MediaType enum value representing the type of media being downloaded.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves to a string containing the pre-signed URL for downloading the file.
The URL can be used to access and download the file without requiring AWS credentials.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createUrlForUpload"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>createUrlForUpload</b></span>
                        <a href="#createUrlForUpload"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createUrlForUpload(extension: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="132"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:132</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Creates a pre-signed URL for uploading a file to Amazon S3.</p>
<p>This function generates a unique key for the file, constructs the S3 object key
based on the media type and current date, and creates a pre-signed URL for uploading.
It also sets cache control headers for the object.</p>
<ul>
<li>url: The pre-signed URL for uploading the file.</li>
<li>key: The generated unique identifier for the file.</li>
<li>path: The S3 path where the file will be stored.</li>
<li>mediaName: The full name of the file including the unique key and extension.</li>
<li>fullPath: The complete S3 URL where the file will be accessible after upload.</li>
</ul>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>extension</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The file extension of the object to be uploaded (e.g., &#39;jpg&#39;, &#39;png&#39;).</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The MediaType enum value representing the type of media being uploaded.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves to an object containing:</p>
<ul>
<li>url: The pre-signed URL for uploading the file.</li>
<li>key: The generated unique identifier for the file.</li>
<li>path: The S3 path where the file will be stored.</li>
<li>mediaName: The full name of the file including the unique key and extension.</li>
<li>fullPath: The complete S3 URL where the file will be accessible after upload.</li>
</ul>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="delete"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>delete</b></span>
                        <a href="#delete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>delete(key: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="86"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:86</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Deletes an object from the specified Amazon S3 bucket.</p>
<p>This result typically includes information about the deletion operation,
such as a deletion marker if versioning is enabled on the bucket.</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>key</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The unique identifier of the object to be deleted from the S3 bucket.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves with the result of the S3 DeleteObjectCommand.
This result typically includes information about the deletion operation,
such as a deletion marker if versioning is enabled on the bucket.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteMultiple"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>deleteMultiple</b></span>
                        <a href="#deleteMultiple"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>deleteMultiple(data: Array<literal type>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="106"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:106</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Deletes multiple objects from the specified Amazon S3 bucket.</p>
<b>Example :</b><div><pre class="line-numbers"><code class="language-none">          the unique identifier of an object to be deleted from the S3 bucket.
     Each object in the array contains information about the deleted item,
     such as its key and version ID (if versioning is enabled on the bucket).
    with deleting any of the specified objects.</code></pre></div></div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                        <code>Array&lt;literal type&gt;</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>An array of objects, each containing a &#39;Key&#39; property that represents
the unique identifier of an object to be deleted from the S3 bucket.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves with an array of successfully deleted objects.
Each object in the array contains information about the deleted item,
such as its key and version ID (if versioning is enabled on the bucket).</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="get"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>get</b></span>
                        <a href="#get"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>get(key: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="68"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:68</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Retrieves an object from an Amazon S3 bucket and returns its content as a URL string.</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>key</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The unique identifier for the object in the S3 bucket.</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The media type of the object, used to determine its path in the bucket.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves to an object containing the URL of the retrieved content.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getMediaPathByType"></a>
                    <span class="name">
                        <span ><b>getMediaPathByType</b></span>
                        <a href="#getMediaPathByType"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getMediaPathByType(type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="198"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:198</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Generates a path for storing media files in S3 based on the media type and current date.</p>
<b>Example :</b><div><pre class="line-numbers"><code class="language-none">          This determines the base folder for the media file.

     The path includes the media type folder and a date-based subfolder.
     Format: &#39;&lt;mediaTypeFolder&gt;/&lt;YYYYMMDD&gt;/&#39;</code></pre></div></div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The type of media being stored, as defined in the MediaType enum.
This determines the base folder for the media file.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </div>
                            <div class="io-description">
                                <p>A string representing the S3 path where the media file should be stored.
The path includes the media type folder and a date-based subfolder.
Format: &#39;<mediaTypeFolder>/<YYYYMMDD>/&#39;</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getMediaTypeForPath"></a>
                    <span class="name">
                        <span ><b>getMediaTypeForPath</b></span>
                        <a href="#getMediaTypeForPath"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getMediaTypeForPath(type: <a href="../undefineds/MediaType.html" target="_self">MediaType</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="218"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:218</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Determines the appropriate storage path for a given media type.</p>
<p>This function maps the MediaType enum to a corresponding string path
used for organizing files in the storage system.</p>
<b>Example :</b><div><pre class="line-numbers"><code class="language-none">          Possible values include images, videos, awards, logos, and remote-service.

     Returns &#39;images&#39; for MediaType.images, &#39;videos&#39; for MediaType.videos,
     &#39;awards&#39; for MediaType.awards, &#39;logos&#39; for MediaType.logos,
     &#39;remote-service&#39; for MediaType[&#39;remote-service&#39;], and &#39;unknown&#39; for any other type.</code></pre></div></div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>type</td>
                                            <td>
                                                            <code><a href="../miscellaneous/enumerations.html#MediaType" target="_self" >MediaType</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The MediaType enum value representing the type of media.
Possible values include images, videos, awards, logos, and remote-service.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </div>
                            <div class="io-description">
                                <p>A string representing the path segment for the given media type.
Returns &#39;images&#39; for MediaType.images, &#39;videos&#39; for MediaType.videos,
&#39;awards&#39; for MediaType.awards, &#39;logos&#39; for MediaType.logos,
&#39;remote-service&#39; for MediaType[&#39;remote-service&#39;], and &#39;unknown&#39; for any other type.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="upload"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>upload</b></span>
                        <a href="#upload"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>upload(fileName: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, file: Buffer)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="49"
                                    class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:49</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">
                        <div class="io-description"><p>Uploads a file to an Amazon S3 bucket.</p>
</div>

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>fileName</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The name of the file to be used as the key in S3.</li>
</ul>

                                            </td>
                                        </tr>
                                        <tr>
                                                <td>file</td>
                                            <td>
                                                        <code>Buffer</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                            <td>
                                                    <ul>
<li>The file content as a Buffer.</li>
</ul>

                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                <p>A Promise that resolves with the result of the S3 PutObjectCommand.</p>

                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="s3Client"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>s3Client</b></span>
                        <a href="#s3Client"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new S3Client({
        region: config.AWS_REGION,
    })</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:33</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="strDefaultAWSBaseURL"></a>
                    <span class="name">
                        <span ><b>strDefaultAWSBaseURL</b></span>
                        <a href="#strDefaultAWSBaseURL"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&#x27;&#x27;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/utilities/services/aws_s3/aws_s3.service.ts:31</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@nestjs/common&#x27;;

// config env
import { config } from &#x27;../../../utilities/config&#x27;;

// uuid for unique file name
import { v4 as uuidv4 } from &#x27;uuid&#x27;;

// day.js - for folder path
import * as dayjs from &#x27;dayjs&#x27;;
var customParseFormat &#x3D; require(&#x27;dayjs/plugin/customParseFormat&#x27;)
dayjs.extend(customParseFormat)

// aws
import { getSignedUrl } from &#x27;@aws-sdk/s3-request-presigner&#x27;;
import { DeleteObjectCommand, DeleteObjectsCommand, GetObjectCommand, PutObjectCommand, S3Client } from &#x27;@aws-sdk/client-s3&#x27;;

export enum MediaType {
    &#x27;images&#x27; &#x3D; &#x27;i&#x27;,
    &#x27;videos&#x27; &#x3D; &#x27;v&#x27;,
    &#x27;awards&#x27; &#x3D; &#x27;a&#x27;,
    &#x27;remote-service&#x27; &#x3D; &#x27;rs&#x27;,
    &#x27;logos&#x27; &#x3D; &#x27;lg&#x27;,
    &#x27;unknown&#x27; &#x3D; &#x27;u&#x27;
}

@Injectable()
export class AwsS3Service {

    // set AWS url by dynamic environment variables
    strDefaultAWSBaseURL &#x3D; &#x27;&#x27;;
    // set AWS region by dynamic environment variables
    private readonly s3Client &#x3D; new S3Client({
        region: config.AWS_REGION,
    });

    constructor() {
        // Set AWS base URL by using the CAR_BUCKET and AWS_REGION environment variables
        this.strDefaultAWSBaseURL &#x3D; &#x27;https://&#x27; + config.AWS_CAR_BUCKET + &#x27;.s3.&#x27; + config.AWS_REGION + &#x27;.amazonaws.com/&#x27;;
    }

    /**
     * Uploads a file to an Amazon S3 bucket.
     * 
     * @param fileName - The name of the file to be used as the key in S3.
     * @param file - The file content as a Buffer.
     * @returns A Promise that resolves with the result of the S3 PutObjectCommand.
     */
    async upload(fileName: string, file: Buffer) {
        return await this.s3Client.send(
            new PutObjectCommand({
                Bucket: config.AWS_CAR_BUCKET,
                Key: fileName,
                CacheControl: &#x27;max-age&#x3D;31536000&#x27;,
                Body: file,
            }),
        );
    }

    /**
     * Retrieves an object from an Amazon S3 bucket and returns its content as a URL string.
     *
     * @param key - The unique identifier for the object in the S3 bucket.
     * @param type - The media type of the object, used to determine its path in the bucket.
     * @returns A Promise that resolves to an object containing the URL of the retrieved content.
     * @throws Will throw an error if the S3 operation fails.
     */
    async get(key: string, type: MediaType) {
        const { Body, } &#x3D; await this.s3Client.send(
            new GetObjectCommand({
                Bucket: config.AWS_CAR_BUCKET,
                Key: this.getMediaPathByType(type) + key,
            })
        );
        return { url: await Body.transformToString() };
    }

    /**
     * Deletes an object from the specified Amazon S3 bucket.
     * 
     * @param key - The unique identifier of the object to be deleted from the S3 bucket.
     * @returns A Promise that resolves with the result of the S3 DeleteObjectCommand.
     * This result typically includes information about the deletion operation,
     * such as a deletion marker if versioning is enabled on the bucket.
     */
    async delete(key: string) {
        return await this.s3Client.send(
            new DeleteObjectCommand({
                Bucket: config.AWS_CAR_BUCKET,
                Key: key,
            })
        );
    }

    /**
     * Deletes multiple objects from the specified Amazon S3 bucket.
     * 
     * @param data - An array of objects, each containing a &#x27;Key&#x27; property that represents
     *               the unique identifier of an object to be deleted from the S3 bucket.
     * @returns A Promise that resolves with an array of successfully deleted objects.
     *          Each object in the array contains information about the deleted item,
     *          such as its key and version ID (if versioning is enabled on the bucket).
     * @throws Will throw an error if the S3 operation fails or if there are issues
     *         with deleting any of the specified objects.
     */
    async deleteMultiple(data: Array&lt;{ Key: string }&gt;) {
        const { Deleted } &#x3D; await this.s3Client.send(
            new DeleteObjectsCommand({
                Bucket: config.AWS_CAR_BUCKET,
                Delete: { Objects: data },
            })
        );
        return Deleted;
    }

    /**
     * Creates a pre-signed URL for uploading a file to Amazon S3.
     *
     * This function generates a unique key for the file, constructs the S3 object key
     * based on the media type and current date, and creates a pre-signed URL for uploading.
     * It also sets cache control headers for the object.
     *
     * @param extension - The file extension of the object to be uploaded (e.g., &#x27;jpg&#x27;, &#x27;png&#x27;).
     * @param type - The MediaType enum value representing the type of media being uploaded.
     * @returns A Promise that resolves to an object containing:
     *   - url: The pre-signed URL for uploading the file.
     *   - key: The generated unique identifier for the file.
     *   - path: The S3 path where the file will be stored.
     *   - mediaName: The full name of the file including the unique key and extension.
     *   - fullPath: The complete S3 URL where the file will be accessible after upload.
     */
    async createUrlForUpload(extension: string, type: MediaType) {
        const key &#x3D; uuidv4();
        const mediaName &#x3D; &#x60;${key}.${extension}&#x60;;
        const command &#x3D; new PutObjectCommand({
            Bucket: config.AWS_CAR_BUCKET,
            Key: this.getMediaPathByType(type) + mediaName,
            // ACL: &#x27;public-read&#x27;
            CacheControl: &#x27;public, max-age&#x3D;2592000, immutable&#x27;,
            Metadata: {
                &#x27;cache-control&#x27;: &#x27;public, max-age&#x3D;2592000, immutable&#x27;
            }
        });
        const url &#x3D; await getSignedUrl(this.s3Client, command, { expiresIn: 60 })
        return { url, key, path: this.getMediaPathByType(type), mediaName, fullPath: this.strDefaultAWSBaseURL + this.getMediaPathByType(type) + mediaName };
    }

    /**
     * Creates a pre-signed URL for downloading a file from Amazon S3.
     * 
     * This function generates a pre-signed URL that allows temporary access to download
     * a specific object from the S3 bucket. The URL is signed with the AWS credentials
     * and expires after a set time.
     *
     * @param key - The unique identifier of the object in the S3 bucket.
     * @param type - The MediaType enum value representing the type of media being downloaded.
     * @returns A Promise that resolves to a string containing the pre-signed URL for downloading the file.
     * The URL can be used to access and download the file without requiring AWS credentials.
     */
    async createUrlForDownload(key: string, type: MediaType) {
        const command &#x3D; new GetObjectCommand({
            Bucket: config.AWS_CAR_BUCKET,
            Key: this.getMediaPathByType(type) + key
        });
        return await getSignedUrl(this.s3Client, command, { expiresIn: 0 });
    }

    /**
     * Creates a pre-signed URL for deleting a file from Amazon S3.
     * 
     * This function generates a pre-signed URL that allows temporary access to delete
     * a specific object from the S3 bucket. The URL is signed with the AWS credentials
     * and expires after 20 seconds.
     *
     * @param key - The unique identifier of the object in the S3 bucket to be deleted.
     * @param type - The MediaType enum value representing the type of media being deleted.
     * @returns A Promise that resolves to a string containing the pre-signed URL for deleting the file.
     *          The URL can be used to delete the file without requiring AWS credentials.
     */
    async createUrlForDelete(key: string, type: MediaType) {
        const command &#x3D; new DeleteObjectCommand({
            Bucket: config.AWS_CAR_BUCKET,
            Key: this.getMediaPathByType(type) + key
        });
        return await getSignedUrl(this.s3Client, command, { expiresIn: 20 });
    }

    /**
     * Generates a path for storing media files in S3 based on the media type and current date.
     * 
     * @param type - The type of media being stored, as defined in the MediaType enum.
     *               This determines the base folder for the media file.
     * 
     * @returns A string representing the S3 path where the media file should be stored.
     *          The path includes the media type folder and a date-based subfolder.
     *          Format: &#x27;&lt;mediaTypeFolder&gt;/&lt;YYYYMMDD&gt;/&#x27;
     */
    getMediaPathByType(type: MediaType) {
        const mType &#x3D; this.getMediaTypeForPath(type);
        const dateFolderType &#x3D; dayjs(new Date()).format(&#x27;YYYYMMDD&#x27;);
        return &#x60;${mType}/${dateFolderType}/&#x60;;
    }

    /**
     * Determines the appropriate storage path for a given media type.
     * 
     * This function maps the MediaType enum to a corresponding string path
     * used for organizing files in the storage system.
     *
     * @param type - The MediaType enum value representing the type of media.
     *               Possible values include images, videos, awards, logos, and remote-service.
     * 
     * @returns A string representing the path segment for the given media type.
     *          Returns &#x27;images&#x27; for MediaType.images, &#x27;videos&#x27; for MediaType.videos,
     *          &#x27;awards&#x27; for MediaType.awards, &#x27;logos&#x27; for MediaType.logos,
     *          &#x27;remote-service&#x27; for MediaType[&#x27;remote-service&#x27;], and &#x27;unknown&#x27; for any other type.
     */
    getMediaTypeForPath(type: MediaType) {
        let typePath &#x3D; &#x27;&#x27;;
        switch (type) {
            case MediaType.images:
                typePath &#x3D; &#x27;images&#x27;;
                break;
            case MediaType.videos:
                typePath &#x3D; &#x27;videos&#x27;;
                break;
            case MediaType.awards:
                typePath &#x3D; &#x27;awards&#x27;;
                break;
            case MediaType.logos:
                typePath &#x3D; &#x27;logos&#x27;;
                break;
            case MediaType[&#x27;remote-service&#x27;]:
                typePath &#x3D; &#x27;remote-service&#x27;;
                break;
            default:
                typePath &#x3D; &#x27;unknown&#x27;;
                break;
        }
        return typePath;
    }
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'AwsS3Service.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
